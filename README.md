**ver:1.1.2.**
Добавлен Favicon
Изменен заголовок списка на "Список хранилищ конфигурации 1С"
![300 Интерфейс](https://github.com/user-attachments/assets/172215d3-ee5d-4e83-80db-8573e1c26297)
Скрипт при обновлении списка сравнивает загружаемый список со списком, 
загруженным в предыдущий раз. Если есть добавленные репозитории или удаленные формируется письмо и отправляется указанным в конфигурационном файле адресам.
![500 настройки конфигурационного файла](https://github.com/user-attachments/assets/0135aa45-602d-440e-907f-50a88e0526ad)

При первом запуске скрипта после считывания структуры папок с хранилищами помещается в массив, который записывается в файл для дальнейшего контроля. 
При дальнейшем обновлении списка, скрипт загружает предыдущее состояния массива из файла, и, если при анализе обнаруживается новые или удаленные 
репозитории – формируется тело письма, после письмо отправляется на адреса, указанные в конфигурационном файле. 

**ver:1.1.1.**
Исправлена ошибка 
заменена строка кода

команда navigator.clipboard по безопасности не отработаывала на IIS
![111110](https://github.com/user-attachments/assets/a32a091d-df22-466e-be0a-f3c6d5ab8198)



**ver:1.1.0.**

Имя скрипта переименовано **UpL1CR.ps1** – аббревиатура от 
**Up**date **L**ist **1C** **R**epository (обновление списка репозиториев) 

Для того чтобы избежать перезаписи уже настроенных файлов, 
доработан механизм чтения файлов **config.ini** и **Description.json** 
путь расположение до которых указывается в переменной окружения Windows. 

Образцы этих файлов находятся в папке SampleFiles репозитория.   

![5 0 Папка с настройками](https://github.com/user-attachments/assets/ffb4f133-08eb-4b86-9fe6-effed526b3cb)

Нужно создать свою папку, например:  
**C:\inetpub\wwwroot\1C_REPOSITORY\PersonalSettings**

положить туда настроенные файлы (Образцы в папке SampleFiles репозитория)

![5 1 Папка с настройками](https://github.com/user-attachments/assets/3dc552dc-6633-4d36-9291-b60fb5c442a8)
![5 2 Пути](https://github.com/user-attachments/assets/16a14950-7bad-4f15-bb31-506039e543dd)

В файле Description.json – храниться описание. 
Если описания для ИБ хранилища есть, то оно сопоставляется по имени
и подставляется в списке в правую колонку. 
![5 3 Описание Json](https://github.com/user-attachments/assets/c9926efb-98f1-43e8-83d1-8677fba5d03e)

Для указания папки нахождения конфигурационных файлов используется переменная окружения Windows. 
Для этого необходимо создать переменную: 
Имя переменной: 		**ConfigListRepository**  
Значение переменной: 	**C:\inetpub\wwwroot\1C_REPOSITORY\PersonalSettings**
![5 4 Переменная среды Windows](https://github.com/user-attachments/assets/72834842-30b1-4960-a23b-ee830b3d9f66)

Если переменная среды не задана, скрипт пытается файлы настроек считать из папки, в которой находится сам. 
![5 6 Поиск рядом](https://github.com/user-attachments/assets/6cb67466-892b-4318-b32e-9c64d1a89b7e)

**Доработка** 
Проверка на случай, когда переменная не найдена в переменных среды, 
скрипт ищет файлы настройки config.ini и Description.json по сетевому пути рядом с «собой».
Если путь настроек вычислен из переменных среды – так же проверяется есть ли файлы по вычисленным путям. 
Если путь настроек вычислить не удается скрипт останавливается по ошибке. 

**Логирование** 
Включение логирования осуществляется наличием файла **UpL1CR.log** в папке, где находится скрипт.

Пишутся события начала работы скрипта. 

Удачное завершение скрипта 

Завершение по ошибке, если переменная среды найдена с некорректных путем до конфигурационных файлов. 

Завершение по ошибке, если конфигурационные файлы не найдены рядом со скриптом. 
![5 6 Работа включенного скрипта](https://github.com/user-attachments/assets/7c4bd949-9e58-4679-8c22-093babc44fa4)


**Добавлен поиск по описанию, убираются строки, не попадающие под условия поиска.** 
![5 7  Поиск по описанию](https://github.com/user-attachments/assets/c685a117-e092-4caa-aa27-3c5b33ce95eb)


ver:1.0.1.
Исправлена сортировка по атрибуту CreationTime - дате создания 
(раньше сортировка работала по дате изменения)

![Сортировка списка баз](https://github.com/user-attachments/assets/4b786936-88b5-49d3-965a-509fe119ae64)

Доработан внешний вид html- документа – текст выровнен по центру. 

![Центровка](https://github.com/user-attachments/assets/daf3113d-ff78-45cd-a929-b9e95016b20b)

ver:1.0.0.
Публикация на IIS  
Создается папка 1C_REPOSITORY в папке публикаций wwwroot, в неё копируются все файлы 

![50 3 wwwroot](https://github.com/user-attachments/assets/7649551b-f97b-4602-b00d-6940f51b0e12)

далее настраивается конфигурационный файл В конфигурационном файле указываем:

•	где находится директория с ИБ Хранилищ

•	где будет лежать html шаблон

•	где будет лежать сам html - файл со списком ИБ Хранилищ

![55 config](https://github.com/user-attachments/assets/bbcc2170-83a3-43c5-9862-1c6a0a464918)

Добавление приложения в IIS

![50 4 Добавление приложения в IIS](https://github.com/user-attachments/assets/7f0fc0b1-1b00-4cff-bb9c-31d5c35aa59a)

![50 5 Параметры приложения](https://github.com/user-attachments/assets/c991774b-c3bd-42ee-8985-3fa19905ff55)

Перезагрузка службы IIS iisreset

Можно посмотреть результат на момент публикации 
https://serp-debug.github.io/1C_REPOSITORY/

Запуск скрипта из командной строки 
![55 Обязательный параметр](https://github.com/user-attachments/assets/555240f9-36d8-451e-9b7c-aae95cdcd535)

